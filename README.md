alignment_filtering
===================

This repository contains materials used for the manuscript, "Limited utility of residue masking for positive-selection inference" by Stephanie J. Spielman, Eric T. Dawson, Claus O. Wilke.
Please direct all questions to Stephanie, at stephanie.spielman@gmail.com (or stephanie.spielman@utexas.edu).

Description of directories and contents as follows.

Manuscript/
	Contains Latex manuscript and corresponding materials (figures, citations, style files, etc)

OSX_scoringprograms/
	Contains source code for C++ programs to carry out residue scoring from bootstrap replicates. All executables have been compiled for Mac OSX. Additionally contains an initial implementation written in python (scoringtest.py) which was NOT used in the study.

PhyloGuidance/
	Contains all code and a README file to run our re-implemented Guidance, PhyloGuidance. See the README within that directory for details. Note that the name "PhyloGuidance" doesn't carry over into the manuscript, but is a nicer name for this directory than "Guidance_Reimplementation."

data/
	Contains final parsed data files and statistics.
	Data files: 
		"fubar_HA_90.txt" and those named similarly were generated either by alignment_filtering/scripts/parsing/parsefubar.py or parsepaml.py, which gather performance information for a posterior probability of 0.9 of calling positive selection. These data files contain most information used in data analysis. 
		The files ending in "RAWSTATS.txt" only contain information about the NUMBER of false positives, true positives, etc. They were generated by the same parsepaml.py and parsefubar.py scripts, just with some local script modifications to what was printed to the outfile. 
		All data files in the directory sweeps/ were generated by alignment_filtering/scripts/sweepfubar.py and sweeppaml.py. These data files contain information needed to plot ROC curves. They gather performance information swept across posterior probability cutoffs 0-1 for all simulation sets.
	Statistics:
		Contain files for R code and output from R to generate statistics on alignment filtering. See each file *code.txt for details about what exactly it is producing. Note that some of the output files have been manually tweaked (added comments or spacing) for easier interpretation of results.
	

scripts/
	Contains code for analyses conducted in manuscript, including sequence simulation, selection inference with FUBAR and PAML M8, and parsing of the raw data files. All alignments were conducted within PhyloGuidance. The README in the scripts/ directory contains more details.